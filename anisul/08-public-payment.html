<!DOCTYPE html>
<html>
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1,user-scalable=no" name="viewport">

    <title>CoinSimple - Your Bitcoin Business Dashboard</title>
	
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="assets/icon_font.css">
	
    <link data-turbolinks-track="true" href="assets/coinsimple.css" media="all" rel="stylesheet">
	
	<link rel="stylesheet/less" type="text/css" href="assets/style.less" />
	<script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.3.1/less.min.js"></script>
	
	<link rel="stylesheet" href="assets/responsive.css" />
</head>

<body class="public_payment">
    <nav class="navbar navbar-default">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="">&nbsp;&nbsp;&nbsp;<img alt="Icon" src="./assets/logo.png"></a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            <div class="col-md-10 col-md-offset-1 pay-invoice page-container">
                <div class="row header">
                    <div class="col-sm-6">
                        <h1>Payment to Eureka Science</h1>

                        <p class="small">For invoice number #33</p>
                    </div>

                    <div class="col-sm-6 text-right">
                        <p class="total">0.00254498 BTC = 10.00 MXN</p>

                        <p class="small">Bitcoin price was taken from MeXBT on March 20th, 2015 18:10 GMT</p>
                    </div>
                </div>

                <div class="row payment">
                    <div class="col-sm-5 text-center">
                        <div id="qrcode" style="margin-top:30px;">
                            <canvas height="200" width="200"></canvas>
                        </div>
                    </div>

                    <div class="col-sm-7 text-center">
                        <p class="btc" id="btc_amount">0.00254498 BTC</p>

                        <p class="address">1AbGyFoxoZiMy5hPgVhMmQ47ujz7xir6Qu</p><a class="btn btn-default" href="bitcoin:1AbGyFoxoZiMy5hPgVhMmQ47ujz7xir6Qu?amount=0.00254498">Launch Wallet</a>

                        <p id="text_info_payment">&nbsp;</p>

                        <p class="countdown" id="countdown_timer">14:31*</p>

                        <p class="disclaimer small text-center">*This address is only active during the alloted time.<br>
                        It is only usable for this purchase. Do not save for any reason.</p>
                    </div>
                </div>
            </div>
        </div>
    </div><script>
var socket = io('https://coinsimple-blockr.herokuapp.com/', {transports: ['websocket', 'polling', 'flashsocket']});
    socket.on('reconnect', function() {
    socket.emit('track_wallet', {address: "1AbGyFoxoZiMy5hPgVhMmQ47ujz7xir6Qu"});
    });
    socket.on('connect', function() {
    socket.emit('track_wallet', {address: "1AbGyFoxoZiMy5hPgVhMmQ47ujz7xir6Qu"});
    });
    var total_to_pay = 254498.0;
    var confirmed = 254498.0;
    socket.on('payment', function(payment) {
    var left = total_to_pay - payment.amount;
    if (left <= 0) {
      window.location = "/processing/invoice/151/r6%7C469e4b6d49cc7e89dfabee9dd7689fc7c134203e78adec966cdcf2642d32ae4a";
    } else if (left <= confirmed) {
      var amount_btc = ((left / 100000000) + 0.000000001).toString();
      var fm = amount_btc.split(".", 2);
      $("#btc_amount").html(fm[0] + "." + fm[1].substr(0, 8) + " BTC");
    }
    });
    $("#qrcode").qrcode({
    size: 200,
    ecLevel: 'M',
    radius: 0.3,
    text: "bitcoin:1AbGyFoxoZiMy5hPgVhMmQ47ujz7xir6Qu?amount=0.00254498"
    });
    var timer = $("#countdown_timer");
    var end_time = 1426875957;
    function update_timer() {
    time = end_time - Math.floor((Date.now()/1000));
    var minutes = Math.floor(time/60).toString();
    var seconds = (time % 60).toString();

    if (minutes.length < 2) {
      minutes = "0" + minutes;
    }
    if (seconds.length < 2) {
      seconds = "0" + seconds;
    }
    if (time < 0) {
      window.location.reload();
    } else {
      timer.text(minutes + ":" + seconds + "*");
    }
    }
    var inter = setInterval(update_timer, 1000);
    </script>
	
	<footer>
        <div class="col-xs-12 col-md-10 col-md-offset-1 footer">
            <p>CoinSimple, 2015</p>
        </div>
    </footer>
</body>
</html>